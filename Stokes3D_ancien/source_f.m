function [fx,fy,fz] = source_f(x,y,z,arg)
%--------------------------------------------------------------------------
% Terme source des equations de Stokes
% arg : arguments supplémentaires :
%   arg(1) = L (largeur du domaine) (dim en x)
%   arg(2) = P (profondeur) (dim en y)
%   arg(3) = H (hauteur) (dim en z)
%   arg(4) = nu (viscosité)
%   arg(5) = F1 (amplitude de la force pour 1 tourbillon)
%   arg(6) = F2 (amplitude de la force pour 2 tourbillons)
%--------------------------------------------------------------------------
L = arg(1);
P = arg(2);
H = arg(3);
nu = arg(4);
F1 = arg(5);
F2 = arg(6);

choix = 3;

switch choix
    case 0
    % terme source pour une solution exacte
        fx=-nu .* (0.2e1 ./ 0.81e2 .* x .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 2) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* (1 - x) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* x .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.243e3 .* (x .^ 3) .* ((1 - x) .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* y .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* (1 - y) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.243e3 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* y .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 2) .* (z .^ 2) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* (1 - y) .* (z .^ 2) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* y .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* (1 - y) .* (z .^ 3) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 3) .* z .* ((1 - z) .^ 3) + 0.2e1 ./ 0.243e3 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 3) .* (1 - z) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 2) .* z .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 2) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 3) .* (1 - z) - 0.2e1 ./ 0.243e3 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* z .* ((1 - z) .^ 2) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* (1 - z) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* (1 - x) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* x .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* (1 - x) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* x .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* (1 - x) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 2))+2.*x;

        fy=-nu .* (0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* y .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 2) .* (z .^ 2) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* (1 - y) .* (z .^ 2) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* y .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* (1 - y) .* (z .^ 3) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.27e2 .* x .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.243e3 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) + 0.2e1 ./ 0.243e3 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* z .* ((1 - z) .^ 2) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* (1 - z) - 0.2e1 ./ 0.27e2 .* (x .^ 2) .* (1 - x) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.243e3 .* (x .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* y .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* x .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* (1 - x) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* x .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* (1 - x) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.81e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 3) .* (1 - y) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* y .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 2) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 3) .* (1 - y) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* z .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.81e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* (1 - z) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* z .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* (1 - z) - 0.2e1 ./ 0.243e3 .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3)); %+2.*y;

        fz=-nu .* (-0.2e1 ./ 0.81e2 .* x .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 2) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* (1 - x) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* x .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.243e3 .* (x .^ 3) .* ((1 - x) .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* y .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* (1 - y) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.243e3 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* x .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 3) .* z .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 3) .* (z .^ 3) .* (1 - z) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 2) .* z .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 2) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 3) .* (1 - z) + 0.2e1 ./ 0.27e2 .* (x .^ 2) .* (1 - x) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.243e3 .* (x .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* y .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 2) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 3) .* (1 - x) .* (y .^ 3) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 3) .* (1 - y) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* y .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 2) .* ((1 - y) .^ 2) .* (z .^ 3) .* ((1 - z) .^ 3) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 3) .* (1 - y) .* (z .^ 3) .* ((1 - z) .^ 3) + 0.2e1 ./ 0.81e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* z .* ((1 - z) .^ 3) - 0.2e1 ./ 0.27e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 2) + 0.2e1 ./ 0.81e2 .* (x .^ 2) .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* (1 - z) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* z .* ((1 - z) .^ 3) + 0.2e1 ./ 0.27e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 2) .* ((1 - z) .^ 2) - 0.2e1 ./ 0.81e2 .* (x .^ 3) .* ((1 - x) .^ 2) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* (1 - z) + 0.2e1 ./ 0.243e3 .* ((1 - x) .^ 3) .* (y .^ 3) .* ((1 - y) .^ 3) .* (z .^ 3) .* ((1 - z) .^ 3)); %+2.*z;
        fx=1e4*fx; fy=1e4*fy; fz=1e4*fz;
    
    case 1
    % Génération d'un tourbillon dans le plan (x,y)
        fx = zeros(size(x)); 
        fy = zeros(size(y)); 
        ind= x<=L/2;
        fy(ind)=1000;
        fz = zeros(size(z));
    
    case 2
    % Génération de deux tourbillons dans le plan (x,y)
        fx = zeros(size(x)); 
        fy = zeros(size(y)); 
        ind= x<=2*L/3 & x>=L/3;
        fy(ind)=1000;
        fz = zeros(size(z));
        
    case 3
    % Superposition de deux tourbillons : 1 tourbillon dans le plan (x,z) +
    % 1 tourbillon dans le plan (y,z)
        
        fx = zeros(size(x)); 
        fy = zeros(size(y)); 
        fz = zeros(size(z));
        
        fx(z>=H/2)=F1;
        ind = z<=H/2;
        fy(ind) = F2;
     
end
    
end
